## OSI网络分层结构

![[Pasted image 20260109144844.png]]

为了方便理解网络基础建设，我们通常从最底层开始介绍：

|**层级**|**名称 (中/英)**|**主要功能 (做什么?)**|**数据单元 (叫什么?)**|**常见协议/设备示例**|**对等通信的重点**|
|---|---|---|---|---|---|
|**L1**|**物理层 (Physical Layer)**|**“传输0和1”**<br><br>  <br><br>负责在物理媒介上发送和接收原始的比特流。定义电压、接口形状、线缆规格等硬件标准。|**比特 (Bit)**|网线(RJ45), 光纤, WiFi电波, 集线器(Hub)|这一端的物理层发送电信号，那一端的物理层接收电信号。|
|**L2**|**数据链路层 (Data Link Layer)**|**“节点到节点传输”**<br><br>  <br><br>将比特组合成“帧”。负责物理寻址（MAC地址）、错误检测，确保相邻两个设备（如电脑到交换机）之间的数据可靠传输。|**帧 (Frame)**|以太网(Ethernet), MAC地址, WiFi协议(802.11), **交换机(Switch)**|这一端的网卡与直接相连的下一跳设备的网卡进行对话。|
|**L3**|**网络层 (Network Layer)**|**“寻址与路由”**<br><br>  <br><br>负责将数据包从源主机跨越多个网络传输到目标主机。核心是逻辑寻址（IP地址）和路径选择（路由）。|**包/分组 (Packet)**|**IP (IPv4/IPv6)**, ICMP (Ping), **路由器(Router)**|源主机的IP层与目标主机的IP层对话（尽管中间经过了多个路由器）。|
|**L4**|**传输层 (Transport Layer)**|**“端到端连接”**<br><br>  <br><br>负责建立主机上应用程序之间的连接。提供可靠传输（TCP）或快速不可靠传输（UDP），以及流量控制和端口号区分不同的应用。|段 (Segment - TCP)<br><br>  <br><br>数据报 (Datagram - UDP)|**TCP** (可靠, 如网页), **UDP** (快速, 如视频直播), 端口号|主机A的TCP进程与主机B的TCP进程进行对话，确保数据完整到达。|
|**L5**|**会话层 (Session Layer)**|**“会话管理”**<br><br>  <br><br>负责建立、管理和终止应用程序之间的会话（连接）。处理断点续传、同步点等。（在现代TCP/IP中常被弱化）。|数据 (Data)|RPC, SQL会话管理|确保两边的应用程序知道对话何时开始、何时结束。|
|**L6**|**表示层 (Presentation Layer)**|**“数据翻译官”**<br><br>  <br><br>负责数据的格式化、加密/解密、压缩/解压缩。确保一个系统的应用层发送的数据能被另一个系统理解。|数据 (Data)|SSL/TLS (加密), JPEG/GIF (图片格式), ASCII/Unicode (编码)|这一端加密的数据，由那一端的表示层解密。|
|**L7**|**应用层 (Application Layer)**|**“人机交互接口”**<br><br>  <br><br>直接为用户的应用程序（如浏览器、邮件客户端）提供网络服务。|数据 (Data)|**HTTP/HTTPS** (网页), **DNS** (域名解析), SMTP/POP3 (邮件), FTP|浏览器与Web服务器之间的对话。|

---
## 发送端：从上到下逐层封装

### 1）应用层（L7 Application）

- 输入：应用数据（例如 HTTP 请求体、DNS 查询、邮件内容）
    
- 输出：**Data（数据）**
    
- 动作：形成应用层报文（可能有应用层头，如 HTTP Header）
    

---

### 2）表示层（L6 Presentation）

- 输入：Data
    
- 输出：Data
    
- 动作：**编码/序列化、压缩、加密/解密**
    
    - 例：UTF-8 编码、TLS 加密（严格说 TLS 常被当作会话/表示层附近的功能）
        

---

### 3）会话层（L5 Session）

- 输入：Data
    
- 输出：Data
    
- 动作：**会话建立/维护/同步**
    
    - 例：会话 ID、对话控制、断点恢复（实际很多实现被上层库或传输层吸收）
        

> 说明：L5/L6/L7 在实际 TCP/IP 协议栈里常被合并视为“应用层”，但在 OSI 分层描述中仍按功能区分。

---

### 4）传输层（L4 Transport）

- 输入：Data
    
- 输出：**Segment（TCP）/ Datagram（UDP）**
    
- 动作：加 **传输层首部（L4 Header）**
    
    - TCP：源端口、目的端口、序号/确认号、窗口、标志位、校验和等
        
    - UDP：源端口、目的端口、长度、校验和等
        
- 结果：`[L4 Header | Data]`
    

---

### 5）网络层（L3 Network）

- 输入：Segment/Datagram
    
- 输出：**Packet（IP 包/分组）**
    
- 动作：加 **网络层首部（L3 Header）**
    
    - 例：源 IP、目的 IP、TTL、协议号（TCP=6/UDP=17）、分片信息等
        
- 结果：`[L3 Header | L4 Header | Data]`
    

---

### 6）数据链路层（L2 Data Link）

- 输入：Packet
    
- 输出：**Frame（帧）**
    
- 动作：加 **链路层首部 + 尾部**
    
    - L2 Header：目的 MAC、源 MAC、类型（如 IPv4/IPv6）/长度、VLAN Tag（可选）
        
    - L2 Trailer：**FCS/CRC 校验（帧尾）**
        
- 结果：`[L2 Header | L3 Header | L4 Header | Data | L2 Trailer(FCS)]`
    

---

### 7）物理层（L1 Physical）

- 输入：Frame
    
- 输出：**Bits（比特流）**
    
- 动作：把帧变成电信号/光信号/无线电波在介质上传输
    
- 结果：`010101...`（比特序列）
    

---

## 接收端：从下到上逐层解封装（与封装相反）

### 1）物理层（L1）

- 收到 Bits → 还原 Frame 的比特序列
    

### 2）数据链路层（L2）

- 校验 FCS（CRC）→ 去掉 L2 Header/Trailer → 得到 Packet（IP 包）
    

### 3）网络层（L3）

- 检查目的 IP、TTL 等 → 去掉 IP Header → 得到 Segment/Datagram
    

### 4）传输层（L4）

- 按端口把数据交给对应进程/套接字
    
- TCP 还会重组、确认、排序等 → 去掉 L4 Header → 得到 Data
    

### 5-7）会话/表示/应用层（L5-L7）

- 解密/解压/解码 → 应用程序拿到原始应用数据（例如 HTTP 请求内容）
    

![[Pasted image 20260109145512.png]]

---

