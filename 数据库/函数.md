### 数值函数

● abs(x)：返回x的绝对值

● ceil(x)：向上取整，返回大于等于 x 的最小整数值

● floor(x)：向下取整，返回小于等于 x 的最大整数值

● round(x, y=0)：四舍五入，将 x 四舍五入 y 位小数，y 不传返回整数，y 为负数时，保留 x 值到小数点左边 y 位

● truncate(x, y)：截断函数，返回被舍去至小数点后 y 位的数字 x，y 为负数时截断小数点左边 y 位

● mod(x, y)：返回 x 除以 y 的余数

● rand()：生成 0-1 的随机数，可以RAND(x),x做种子，相同的x生成相同的随机数

### 字符函数

● concat(s1, s2, ...)：字符串连接，如果任何一个参数为null，则返回值为null

● concat_ws(x, s1, s2, ...)：指定分隔符的字符连接函数，x是连接分隔符，如果分隔符为 null，则结果为 null。

● lower(str)：大写转小写

● upper(str)：小写转大写

● length(str)：字符串长度

● ltrim(str)：删除字符串左侧空格

● rtrim(str)：删除字符串右侧空格

● trim(str)：删除字符串两侧空格

● substr(str, n, len)：截取子字符串，字符串 str 从 n 的位置截取长度为 len 的字符串，如果n为负数，则子字符串的位置起始于字符串结尾的n个字符

● left(str, n)：返回字符串 str 的最左边 n 个字符

● right(str, n): 返回字符串 str 的最右边 n 个字符

● replace(str, from_str, to_str)：替换函数，字符串 str 中所有的字符串 from_str 均被 to_str 替换，然后返回这个字符串

● format(x, n)：将数字 x 格式化，并以四舍五入的方式保留小数点后 n 位，结果以字符串的形式返回。若 n 为0，则返回结果不含小数部分。

### 日期时间函数

● curdate()/current_date()：获取当前日期，YYYY-MM-DD 格式

● curtime()/current_time()：获取当前时间，HH:MM:SS 格式

● week(date)：返回date为一年中的第几周

● now()/sysdate()：获取当前日期和时间，YYYY-MM-DD HH:MM:SS 格式

● date_add(date, interval expr type)：执行日期的加运算，date是一个datetime或 date 值，指定起始时间。expr是时间间隔。type为关键词，如YEAR, MONTH, DAY, WEEK, HOUR等。

● datediff(date1, date2)：计算两个日期之间的间隔天数

● unix_timestamp(date)：返回date的UNIX时间戳

● form_unixtime(unix)：返回unix时间戳的日期值

● date_format(date, format)：日期格式化，按format格式化date值

● str_to_date(date, format)：将字符串转换成date类型

|   |   |
|---|---|
|date_format|时间日期格式|
|%Y：4位数形式表示年份|%y：2位数形式表示年份|
|%b：月份，缩写名称(Jan...Dec)|%c：月份，数字形式(0...12)|
|%m：月份，数字形式(00...12)|%M：月份名称(January..Dec)|
|%d：该月日期，数字形式(00...31)|%e：该月日期，数字形(0...31)|
|%p：上下午，am、pm|%h: 时|
|%i : 分|%s或%S：秒|

### 聚合函数（分组函数）

● avg(expression)：返回某列的平均值

● sum(expression)：返回某列值的和

● count(expression)：返回某列的行数。 尽量用count(\*) count(1)

● max(expression)：返回某列的最大值

● min(expression)：返回某列的最小值

注意：

● 聚合函数会自动的忽略空值，不需要手动增加条件排除NULL

● 聚合函数不能作为 where 子句后的限制条件
可以这样写：
```SQL
SELECT emp_id, salary
FROM employees
WHERE salary > (SELECT AVG(salary) FROM employees);
```
### 流程函数

● if(value, t, f)：如果value为真返回t，否则返回f

● ifnull(column, value)：如果column为空返回value，否则返回column

在 SQL 语句当中若有 NULL 值参与数学运算，计算结果一定是 NULL，为了防止计算结果出现 NULL，建议先使用 ifnull 空值处理函数预先处理。
## 1) 总览表

|类型|名称|语法|返回规则/要点|典型用法|
|---|---|---|---|---|
|标准分支|`CASE`（搜索式）|`CASE WHEN cond THEN v ... ELSE v END`|按条件从上到下匹配，命中即返回|多条件分类、区间判断|
|标准分支|`CASE`（简单式）|`CASE expr WHEN v1 THEN r1 ... ELSE r END`|比较 `expr` 与各 `v`（等值）|枚举映射（状态码→文字）|
|MySQL 分支|`IF`|`IF(cond, v_true, v_false)`|cond 为真返回 v_true，否则 v_false|两分支判断|
|空值回退|`IFNULL`|`IFNULL(x, y)`|x 非 NULL 返回 x，否则 y|NULL 兜底显示|
|空值回退（标准）|`COALESCE`|`COALESCE(a,b,c,...)`|返回第一个非 NULL|多级兜底|
|三值比较|`NULLIF`|`NULLIF(a,b)`|若 a=b 返回 NULL，否则返回 a|“相等则置空”、避免除零|
CASE函数实例：
```SQL
SELECT
  emp_id,
  salary,
  CASE
    WHEN salary >= 20000 THEN 'A'
    WHEN salary >= 10000 THEN 'B'
    ELSE 'C'
  END AS salary_grade
FROM employees;
```

COALESCE实例：
```SQL
SELECT COALESCE(NULL, NULL, 'X', 'Y');  -- 返回 'X'
SELECT COALESCE(NULL, NULL);            -- 返回 NULL
```

## 单行函数与多行函数
## 1) 核心区别

| 维度   | 单行函数                                                          | 多行函数（组函数/聚合函数）                              |
| ---- | ------------------------------------------------------------- | ------------------------------------------- |
| 作用对象 | **一行**（对每一行分别计算）                                              | **多行**（对一组行汇总计算）                            |
| 输入行数 | 1 行输入 → 1 行输出（对每行都算一次）                                        | N 行输入 → 1 个值输出（或按 GROUP 分组后每组 1 个值）         |
| 典型代表 | `UPPER()`、`SUBSTR()`、`ROUND()`、`COALESCE()`、`DATE_FORMAT()` 等 | `COUNT()`、`SUM()`、`AVG()`、`MIN()`、`MAX()` 等 |
| 常见搭配 | `WHERE` 过滤、`SELECT` 计算列                                       | `GROUP BY` 分组、`HAVING` 分组过滤                 |
| 常见错误 | 无                                                             | 把非聚合列和聚合列混写但不 `GROUP BY`（会报错或产生不确定结果）       |
## 三角函数
| 类别          | 函数          | 签名/返回                  | 单位与要点                       | 示例（MySQL）             |
| ----------- | ----------- | ---------------------- | --------------------------- | --------------------- |
| 角度↔弧度       | `RADIANS`   | `RADIANS(deg) -> rad`  | 度转弧度                        | `RADIANS(180)` = π    |
| 角度↔弧度       | `DEGREES`   | `DEGREES(rad) -> deg`  | 弧度转度                        | `DEGREES(PI())` = 180 |
| 基础三角        | `SIN`       | `SIN(x) -> [-1,1]`     | x 为弧度                       | `SIN(PI()/2)` = 1     |
| 基础三角        | `COS`       | `COS(x) -> [-1,1]`     | x 为弧度                       | `COS(0)` = 1          |
| 基础三角        | `TAN`       | `TAN(x)`               | x 为弧度；在 π/2 + kπ 附近趋于无穷     | `TAN(PI()/4)` = 1     |
| 反三角         | `ASIN`      | `ASIN(y) -> rad`       | y ∈ [-1,1]                  | `ASIN(1)` = π/2       |
| 反三角         | `ACOS`      | `ACOS(y) -> rad`       | y ∈ [-1,1]                  | `ACOS(0)` = π/2       |
| 反三角         | `ATAN`      | `ATAN(y) -> rad`       | 输入任意实数                      | `ATAN(1)` = π/4       |
| 反三角（象限）     | `ATAN2`     | `ATAN2(y, x) -> rad`   | 按 (y,x) 判象限，比 `ATAN(y/x)`安全 | `ATAN2(1, -1)` = 3π/4 |
| 余切（无内置时）    | （表达式）       | `1/TAN(x)`             | MySQL 无 `COT()` 时可用表达式      | `1/TAN(PI()/4)` = 1   |
| 正割/余割（无内置时） | （表达式）       | `1/COS(x)`, `1/SIN(x)` | 多数 SQL 无 `SEC/CSC`          | `1/COS(0)` = 1        |
| 常量          | `PI`/`PI()` | 返回 π                   | MySQL 用 `PI()`              | `PI()` ≈ 3.14159      |
- 如果你的输入是“度”，要写：`SIN(RADIANS(角度))`，否则结果会错。
    
- `ASIN/ACOS` 的参数超出 `[-1,1]` 会返回 `NULL`（或报域错误，依数据库而定）。
    
- `ATAN2(y,x)` 推荐用于方向角/方位角计算（能正确区分象限）。

----
## 进制转换函数
|需求|函数/语法|签名/返回|要点|示例（MySQL）|
|---|---|---|---|---|
|任意进制字符串 → 十进制整数|`CONV`|`CONV(N, from_base, to_base) -> STRING`|`N` 可为数字或字符串；返回是**字符串**；支持 base 2–36|`CONV('1010', 2, 10)` → `'10'`|
|十进制整数 → 任意进制字符串|`CONV`|同上|常用 to_base=2/8/16|`CONV(255, 10, 16)` → `'FF'`|
|整数 → 二进制字符串（位串）|`BIN`|`BIN(N) -> STRING`|无前导 0|`BIN(10)` → `'1010'`|
|整数 → 八进制字符串|`OCT`|`OCT(N) -> STRING`|MySQL 也可写 `OCTAL`（视版本）；无前导 0|`OCT(64)` → `'100'`|
|整数 → 十六进制字符串|`HEX`|`HEX(N) -> STRING`|对数字返回大写 hex；对字符串返回其字节的 hex|`HEX(255)` → `'FF'`|
|十六进制字符串/字面量 → 十进制（数值）|`CONV` 或隐式/显式转换|`CONV(hex,16,10)`|`HEX()` 的逆通常用 `CONV`；也可用 `0x..` 字面量|`CONV('FF',16,10)` → `'255'`；`SELECT 0xFF+0` → `255`|
|十六进制字面量（bytes）→ 还原为字符串|`UNHEX`|`UNHEX(hexstr) -> BINARY`|返回二进制；若想显示文本，需按字符集转换|`UNHEX('48656C6C6F')` → `0x48656C6C6F`（Hello）|
|字符串 → 按字节转十六进制（编码查看）|`HEX`|`HEX(str) -> STRING`|用于看字符串的字节表示|`HEX('Hi')` → `'4869'`（取决于字符集）|
|二进制/八进制/十六进制数值字面量|`0b` / `0o` / `0x`|返回数值|`0b`、`0x` 常见；`0o` 视 MySQL 版本支持情况|`SELECT 0b1010, 0xFF;` → `10, 255`|

### 两个常见注意点

1. **`CONV` 返回类型是字符串**：需要数值运算时可用 `+0` 或 `CAST(... AS UNSIGNED)` 转成数值。  
    例如：`SELECT CONV('FF',16,10)+0;`
    
2. **`HEX/UNHEX` 对“字符串 vs 数字”行为不同**：
    
    - `HEX(255)`：把数值 255 转 hex
        
    - `HEX('255')`：把字符串 `'255'` 的字节序列转 hex