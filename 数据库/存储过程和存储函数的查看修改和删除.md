管理 MySQL 存储过程（Stored Procedures）和存储函数（Stored Functions）主要涉及 **查看元数据、修改特性**以及**彻底删除**。

由于存储过程和函数在管理上非常相似，以下将它们统称为“子程序”。

---

### 1. 查看 (Viewing)

你可以通过不同的维度来查看子程序的信息：其定义内容、状态或系统元数据。

#### A. 查看具体定义（源代码）

如果你想看这个存储过程当初是怎么写的（`BEGIN...END` 里的内容），使用：


```SQL
SHOW CREATE PROCEDURE 存储过程名;
SHOW CREATE FUNCTION 函数名;
```

#### B. 查看状态列表

如果你想列出数据库中所有的存储过程或函数（包括创建时间、修改时间、特性等）：

```SQL
SHOW PROCEDURE STATUS [LIKE 'pattern'];
SHOW FUNCTION STATUS [LIKE 'pattern'];


//实例
SHOW FUNCTION STATUS LIKE 'email_by_id';
SHOW PROCEDURE STATUS LIKE 'emp_max_salary';
```

_示例：`SHOW PROCEDURE STATUS WHERE Db = 'my_db';`_

#### C. 通过系统表查询

在 `information_schema` 库中，`ROUTINES` 表存储了最详尽的信息：


```SQL
SELECT * FROM information_schema.ROUTINES 
WHERE ROUTINE_NAME = '你的名字' AND ROUTINE_SCHEMA = '数据库名';

//或者
select * from information_schema.ROUTINES
WHERE ROUTINE_NAME. = '表名' AND ROUTINE_TYPE = '[PROCEDURE | FUNCTION]';
```

---

### 2. 修改 (Modifying)

这是一个常见的误区：**MySQL 的 `ALTER` 语句不能修改子程序的业务逻辑（即 `BEGIN...END` 块中的内容）。**

#### A. 使用 ALTER 修改特性

`ALTER` 仅能修改我们在上一轮讨论中提到的“特性限定符”（Characteristics）：

```SQL
ALTER PROCEDURE 存储过程名
MODIFIES SQL DATA -- 修改数据访问特性
SQL SECURITY INVOKER -- 修改安全权限
COMMENT '更新后的备注信息'; -- 修改注释
```

#### B. 修改逻辑（业务代码）

如果你需要修改 `BEGIN...END` 里的代码，标准做法是**“先删除，再重建”**：

1. 复制原有的 `CREATE` 语句。
    
2. 修改代码。
    
3. 执行 `DROP`。
    
4. 执行新的 `CREATE`。
    

> **提示：** 如果使用 Navicat、MySQL Workbench 或 DBeaver 等图形化工具，直接在界面修改并保存，工具会在后台自动帮你执行“删除+重建”的过程。

---

### 3. 删除 (Deleting)

删除操作非常直接，建议加上 `IF EXISTS` 以防止报错。


```SQL
-- 删除存储过程
DROP PROCEDURE IF EXISTS 存储过程名;

-- 删除存储函数
DROP FUNCTION IF EXISTS 函数名;
```

---

### 总结表

|操作类型|关键字|说明|
|---|---|---|
|**查看定义**|`SHOW CREATE`|查看源代码（BEGIN...END）。|
|**查看列表**|`SHOW STATUS`|查看所有子程序的状态摘要。|
|**修改特性**|`ALTER`|**仅限**修改 COMMENT、SECURITY、DATA ACCESS 等。|
|**修改逻辑**|`DROP` + `CREATE`|必须删除后再重新创建。|
|**删除**|`DROP`|永久移除子程序。|

Export to Sheets

---

**温馨提示：** 在删除并重建存储过程时，请务必注意**权限（Grants）**。当你 `DROP` 一个过程后再 `CREATE`，之前赋予给特定用户的执行权限（EXECUTE privilege）会消失，你需要重新授权。

**您现在是准备对某个具体的存储过程进行重构（修改逻辑）吗？如果是的话，我可以帮您检查重构后的 SQL 语法。**